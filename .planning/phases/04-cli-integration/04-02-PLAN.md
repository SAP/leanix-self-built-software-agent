---
phase: 04-cli-integration
plan: 02
type: execute
---

<objective>
Add context management CLI command for initializing context template files.

Purpose: Help users bootstrap their context configuration by generating template files with documentation.
Output: New `sbs-ai-discovery context init` command that creates template context files.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# Prior phase summaries:
@.planning/phases/02-context-discovery/02-01-SUMMARY.md

# Key files:
@src/cli/main.py
@src/services/context_loader.py

**Tech stack available:**
- Click 8.2.1+ for CLI
- Rich for console output
- pathlib for file operations

**Established patterns:**
- Command groups in separate files (discover.py, sync.py)
- Commands registered in main.py via cli.add_command()
- Rich console for user feedback

**Context file locations:**
- Org context: ~/.sbs-discovery/{org}.md
- Repo context: .sbs-discovery.md in repo root
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create context command group with init subcommand</name>
  <files>src/cli/context.py, src/cli/main.py</files>
  <action>
Create new src/cli/context.py with a Click command group:

1. Create context_group as @click.group() named 'context'
2. Add 'init' subcommand with options:
   - --org: Organization name (creates ~/.sbs-discovery/{org}.md)
   - --repo: Flag to create .sbs-discovery.md in current directory
   - --force: Overwrite existing files (default: False)

3. Command logic:
   - If --org provided: create org context file at ~/.sbs-discovery/{org}.md
   - If --repo flag: create repo context file at ./.sbs-discovery.md
   - If neither: show error asking user to specify --org or --repo
   - If file exists and no --force: show warning and skip

4. Register in main.py:
   ```python
   from src.cli.context import context_group
   cli.add_command(context_group, name='context')
   ```

Use Rich console for colorful output (success in green, warnings in yellow).
  </action>
  <verify>Run `python -m src.cli.main context --help` and verify init subcommand appears</verify>
  <done>context command group registered with init subcommand visible in help</done>
</task>

<task type="auto">
  <name>Task 2: Add template generation with helpful documentation</name>
  <files>src/cli/context.py</files>
  <action>
Create template content that helps users understand what to put in context files:

1. Define ORG_CONTEXT_TEMPLATE constant:
```markdown
# Organization Context for {org}

This file provides context to AI agents during repository discovery.
Place organization-wide hints, patterns, and conventions here.

## Naming Conventions
<!-- Example: Our services follow the pattern: {team}-{function}-service -->

## Deployment Patterns
<!-- Example: All production services deploy to Kubernetes in namespace 'prod' -->

## Team Ownership Rules
<!-- Example: Repositories prefixed with 'platform-' belong to Platform team -->

## Technology Standards
<!-- Example: We use Python 3.11+ for all backend services -->

## Custom Indicators
<!-- Add any domain-specific hints that help identify services -->
```

2. Define REPO_CONTEXT_TEMPLATE constant:
```markdown
# Repository Context

This file provides context to AI agents during discovery of this repository.
Repository-specific hints override organization defaults.

## Service Information
<!-- Example: This is a microservice handling user authentication -->

## Deployment Details
<!-- Example: Deploys to production via GitHub Actions to AWS ECS -->

## Team Ownership
<!-- Example: Owned by Identity team, contact: identity@company.com -->

## Technology Notes
<!-- Example: Uses FastAPI with PostgreSQL, Redis for caching -->

## Special Considerations
<!-- Any unusual patterns or exceptions for this repo -->
```

3. In init command:
   - Create ~/.sbs-discovery/ directory if needed (for org context)
   - Write template with {org} placeholder replaced
   - Show success message with file path
   - If --repo, ensure not in home directory (safety check)
  </action>
  <verify>
Run init commands and verify file creation:
```bash
python -m src.cli.main context init --org testorg
cat ~/.sbs-discovery/testorg.md
python -m src.cli.main context init --repo
cat .sbs-discovery.md
```
Verify both files contain helpful template content
  </verify>
  <done>Template files created with documentation, placeholders replaced correctly</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `sbs-ai-discovery context --help` shows context command group
- [ ] `sbs-ai-discovery context init --help` shows --org, --repo, --force options
- [ ] `context init --org myorg` creates ~/.sbs-discovery/myorg.md with template
- [ ] `context init --repo` creates ./.sbs-discovery.md with template
- [ ] Existing files not overwritten without --force
- [ ] --force flag overwrites existing files
- [ ] Templates contain helpful documentation comments
</verification>

<success_criteria>

- All tasks completed
- All verification checks pass
- Users can bootstrap context files with single command
- Phase 4 complete (all CLI integration done)
</success_criteria>

<output>
After completion, create `.planning/phases/04-cli-integration/04-02-SUMMARY.md`
</output>
